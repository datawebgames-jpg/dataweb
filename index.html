<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DATAWEB | Asesoramientos y Tr√°mites Online</title>
  <meta name="description" content="DATAWEB - Asesoramientos online: tr√°mites, ciudadan√≠as, pagos, gestor√≠as y asesoramiento tecnol√≥gico. Clima y noticias locales autom√°ticamente seg√∫n tu ubicaci√≥n." />

  <!-- Fonts (system fallback) -->
  <style>
    :root{
      --bg:#fbfdff;
      --card:#ffffff;
      --text:#0a2e5c;
      --muted:#6b7a90;
      --primary:#1e5fb3;
      --accent:#25D366;
      --success-bg:#e6f7ee;
      --success-border:#2fa66a;
    }
    /* Dark mode */
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#071025;
        --card:#071428;
        --text:#dff1ff;
        --muted:#9fb6d0;
        --primary:#4ea0ff;
        --accent:#25D366;
      }
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Top animated bar */
    .top-bar{
      width:100%;
      background:linear-gradient(90deg,var(--primary),#4aa3ff 60%, #ffffff);
      color:white;
      padding:6px 0;
      overflow:hidden;
      position:relative;
      font-weight:600;
      font-size:0.95rem;
    }
    .top-bar span{
      position:absolute;
      width:100%;
      animation:marquee 18s linear infinite;
      white-space:nowrap;
      text-shadow:0 0 8px rgba(255,255,255,0.55);
    }
    @keyframes marquee{
      0%{transform:translateX(100%);opacity:.8}
      15%{opacity:1}
      85%{opacity:1}
      100%{transform:translateX(-100%);opacity:.8}
    }

    /* Header compact with subtle gradient */
    header{
      background: linear-gradient(90deg, rgba(10,46,92,0.95), rgba(30,95,179,0.95));
      color: #fff;
      padding: 12px 14px;
      height: 120px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      gap:6px;
    }
    header h1{ margin:0; font-size:1.6rem; letter-spacing:1px; }
    header .contact{ font-size:0.95rem; opacity:0.95 }

    /* Layout */
    .container{ max-width:1200px; margin:18px auto; padding:0 14px; }
    main{ display:grid; grid-template-columns: 2fr 1fr; gap:16px; align-items:start; }
    @media (max-width:980px){ main{ grid-template-columns: 1fr } }

    .card{ background:var(--card); border-radius:12px; padding:14px; box-shadow:0 8px 20px rgba(12,36,78,0.04); }

    h2{ margin:0 0 10px 0; color:var(--primary) }
    p.muted{ margin:0; color:var(--muted) }

    .services{ display:grid; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); gap:10px; margin-top:10px; }
    .svc{ background:linear-gradient(180deg,#fff,#fbfdff); border-radius:8px; padding:10px; border:1px solid rgba(30,95,179,0.06) }

    /* Forms */
    form{ display:flex; flex-direction:column; gap:10px }
    input, textarea, select{ padding:10px; border-radius:8px; border:1px solid #d6e3ff; background: #fff; color:var(--text) }
    textarea{ min-height:100px; resize:vertical }
    .btn{ background:var(--primary); color:#fff; padding:10px; border-radius:8px; border:0; font-weight:700; cursor:pointer }

    /* Sidebar elements */
    .small{ margin-bottom:12px }
    .kpi{ display:flex; justify-content:space-between; align-items:center; gap:8px }
    .quick-icons{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px }
    .quick-icon{ flex:0 0 48%; display:flex; gap:8px; align-items:center; padding:8px; border-radius:8px; background:linear-gradient(180deg,#fff,#f6faff); cursor:pointer; border:1px solid rgba(10,46,92,0.04) }

    .confirm{ display:none; padding:10px; border-radius:8px; margin-bottom:10px; }

    .tweets{ padding:10px }

    .clima{ padding:8px; text-align:center; border-radius:8px; background:linear-gradient(180deg,#fff,#f6fbff) }

    .social { text-align:center }

    .cta-buy{ margin-top:12px; background:linear-gradient(90deg,var(--primary),#0a55a8); color:white; padding:14px; border-radius:10px; text-align:center }

    footer{ text-align:center; color:var(--muted); padding:20px 0; margin-top:20px }

    a{ color:var(--primary) }
  </style>
</head>
<body>

  <div class="top-bar"><span>‚ú® Asesoramiento online ‚Ä¢ Tr√°mites ‚Ä¢ Ciudadan√≠as ‚Ä¢ Tecnolog√≠a ‚Ä¢ Compras seguras y tasaciones ‚ú®</span></div>

  <header>
    <h1><span id="brand">DATAWEB</span></h1>
    <div class="contact">üì± +54 2954 320639 ‚Ä¢ ‚úâÔ∏è dataweb76@gmail.com</div>
  </header>

  <div class="container">
    <main>
      <!-- LEFT -->
      <div>
        <section class="card" aria-labelledby="welcome">
          <h2 id="welcome">Bienvenido a DATAWEB</h2>
          <p class="muted">Tu asesor digital para tr√°mites, ciudadan√≠as, pagos, gestor√≠as y asesoramiento en tecnolog√≠a. Complet√° un formulario o chate√° por WhatsApp.</p>

          <div class="services" aria-label="Servicios">
            <div class="svc"><strong>Ciudadan√≠as</strong><p class="muted">Espa√±ola, Italiana y armado de carpetas IDU.</p></div>
            <div class="svc"><strong>Pagos & Facturas</strong><p class="muted">Gesti√≥n y asesoramiento para pagar servicios.</p></div>
            <div class="svc"><strong>Gestor√≠a</strong><p class="muted">Automotor, municipal y gestor√≠as generales.</p></div>
            <div class="svc"><strong>Tecnolog√≠a</strong><p class="muted">Asesoramiento en compra de PCs, notebooks y celulares.</p></div>
          </div>
        </section>

        <section class="card" id="contact-section" aria-labelledby="contacto-title">
          <h2 id="contacto-title">Contacto / Ped√≠ tu asesoramiento</h2>
          <p class="muted">Complet√° el formulario y te contactamos por mail o WhatsApp.</p>

          <div id="general-confirm" class="confirm" role="status" aria-live="polite"></div>

          <form id="general-form">
            <select id="g-service" name="service_type" required>
              <option value="Formulario General">Consulta general</option>
              <option value="Ciudadan√≠a">Ciudadan√≠a</option>
              <option value="Gestor√≠a Automotor">Gestor√≠a Automotor</option>
              <option value="Municipal">Tr√°mite Municipal</option>
              <option value="Asesoramiento Tecnol√≥gico">Tecnolog√≠a</option>
            </select>
            <input id="g-name" name="user_name" type="text" placeholder="Tu nombre" required />
            <input id="g-email" name="user_email" type="email" placeholder="Tu correo" required />
            <input id="g-whatsapp" name="user_whatsapp" type="text" placeholder="Tu WhatsApp (ej: +5492954...)" />
            <textarea id="g-message" name="user_message" placeholder="Contanos en qu√© te podemos ayudar..." required></textarea>
            <button class="btn" type="submit">Enviar consulta</button>
          </form>
        </section>

        <section class="card" id="local-news-section">
          <h2>Noticias de tu zona</h2>
          <div id="news-list">
            <p class="muted">Detectando ubicaci√≥n para mostrar noticias regionales...</p>
          </div>
        </section>
      </div>

      <!-- RIGHT -->
      <aside>
        <div class="card small clima">
          <h3 style="margin:0 0 8px 0">üå§Ô∏è Clima local</h3>
          <div id="clima-content"><p class="muted">Obteniendo clima...</p></div>
        </div>

        <div class="card small">
          <h3 style="margin:0 0 8px 0">üíµ D√≥lar hoy (Argentina)</h3>
          <div class="kpi"><div class="left">Oficial</div><div id="d-oficial" class="right">Cargando...</div></div>
          <div class="kpi" style="margin-top:8px"><div class="left">Blue</div><div id="d-blue" class="right">Cargando...</div></div>
          <div style="margin-top:8px"><a class="muted" href="https://www.dolarhoy.com/" target="_blank" rel="noopener">Ver tabla completa</a></div>
        </div>

        <div class="card tweets">
          <h3 style="margin:0 0 8px 0">üê¶ √öltimos Tweets</h3>
          <div style="display:flex;flex-direction:column;gap:6px">
            <a href="https://twitter.com/lanacion" target="_blank">@LANACION</a>
            <a href="https://twitter.com/clarincom" target="_blank">@clarincom</a>
          </div>
          <div style="margin-top:8px" class="muted">Para embed completo activ√° widgets X en producci√≥n.</div>
        </div>

        <div class="card small">
          <h3 style="margin:0 0 8px 0">üí¨ Consultas R√°pidas</h3>
          <p class="muted" style="margin:0 0 8px 0">Eleg√≠ un tipo, dej√° tu mail/WhatsApp y te contestamos con tarifa estimada.</p>

          <div class="quick-icons" id="quick-icons">
            <div class="quick-icon" data-type="ARBA">üèõÔ∏è <div style="font-weight:600">ARBA</div></div>
            <div class="quick-icon" data-type="Municipal">üèôÔ∏è <div style="font-weight:600">Municipal</div></div>
            <div class="quick-icon" data-type="Gestor√≠a Automotor">üöó <div style="font-weight:600">Gestor√≠a</div></div>
            <div class="quick-icon" data-type="Ciudadan√≠a">üõÇ <div style="font-weight:600">Ciudadan√≠a</div></div>
          </div>

          <div id="quick-confirm" class="confirm"></div>

          <form id="quick-form">
            <input type="hidden" id="quick-type" name="service_type" value="">
            <input id="quick-email" name="user_email" type="email" placeholder="Tu correo electr√≥nico" required>
            <input id="quick-whatsapp" name="user_whatsapp" type="text" placeholder="Tu WhatsApp (opcional)">
            <textarea id="quick-message" name="user_message" placeholder="Mensaje breve (opcional)"></textarea>
            <button class="btn" type="submit">Enviar consulta r√°pida</button>
          </form>
        </div>

        <div class="card small social">
          <h3 style="margin:0 0 8px 0">¬øTe gusta DATAWEB?</h3>
          <iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Ftuusuario.github.io%2Fdataweb&width=180&layout=button_count&action=like&size=large&share=true&height=35"
            width="200" height="35" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
          <div style="margin-top:10px">
            <button class="btn" style="background:#e1306c" onclick="compartirInstagram()">üì∏ Compartir en Instagram</button>
          </div>
        </div>
      </aside>
    </main>

    <!-- CTA compras / tasaci√≥n -->
    <div style="max-width:1200px;margin:18px auto;padding:0 14px">
      <div class="cta-buy">
        <h3 style="margin:0 0 8px 0">üõçÔ∏è Compras seguras o tasaci√≥n</h3>
        <p style="margin:0 0 12px 0">Te ayudamos a comprar con seguridad o a tasar lo que quer√©s vender. Eleg√≠ y dej√° tus datos.</p>
        <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center">
          <button class="btn" onclick="enviarConsulta('Compras Seguras')">üõí Compras seguras</button>
          <button class="btn" onclick="enviarConsulta('Tasaci√≥n / Venta')">üí∞ Tasaci√≥n / Vender</button>
        </div>
      </div>
    </div>

    <footer>¬© 2025 DATAWEB ‚Ä¢ Asesoramientos ‚Ä¢ ‚úâÔ∏è dataweb76@gmail.com ‚Ä¢ üì± +54 2954 320639</footer>
  </div>

  <!-- SCRIPTS -->
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script>
    (function(){
      // EmailJS init (public key)
      emailjs.init('s4mg-ltaKMlUUoXhb');
      const SERVICE_ID = 'service_bliy8jc';
      const TEMPLATE_ID = 'template_zr5w5se';

      /* ---------- Forms handling ---------- */
      const genForm = document.getElementById('general-form');
      const genConfirm = document.getElementById('general-confirm');

      genForm.addEventListener('submit', function(e){
        e.preventDefault();
        const params = {
          service_type: document.getElementById('g-service').value || 'Formulario General',
          user_name: document.getElementById('g-name').value.trim(),
          user_email: document.getElementById('g-email').value.trim(),
          user_whatsapp: document.getElementById('g-whatsapp').value.trim() || 'No provisto',
          user_message: document.getElementById('g-message').value.trim(),
          to_email: 'dataweb76@gmail.com'
        };
        if(!params.user_name || !params.user_email || !params.user_message){
          showConfirm(genConfirm, 'Complet√° nombre, correo y mensaje.', false);
          return;
        }
        emailjs.send(SERVICE_ID, TEMPLATE_ID, params).then(()=> {
          showConfirm(genConfirm, '‚úÖ Tu consulta fue enviada. Te responderemos por mail o WhatsApp.', true);
          genForm.reset();
        }, (err)=> {
          console.error('EmailJS error', err);
          showConfirm(genConfirm, '‚ö†Ô∏è Ocurri√≥ un error al enviar. Intent√° por WhatsApp.', false);
        });
      });

      // Quick form
      const quickIcons = document.querySelectorAll('.quick-icon');
      const quickTypeInput = document.getElementById('quick-type');
      quickIcons.forEach(icon => {
        icon.addEventListener('click', ()=> {
          const t = icon.getAttribute('data-type');
          quickTypeInput.value = t;
          icon.style.boxShadow = '0 8px 20px rgba(30,95,179,0.12)';
          setTimeout(()=> icon.style.boxShadow = '', 1000);
          document.getElementById('quick-email').focus();
        });
      });

      const quickForm = document.getElementById('quick-form');
      const quickConfirm = document.getElementById('quick-confirm');
      quickForm.addEventListener('submit', function(e){
        e.preventDefault();
        const params = {
          service_type: document.getElementById('quick-type').value || 'Consulta R√°pida',
          user_email: document.getElementById('quick-email').value.trim(),
          user_whatsapp: document.getElementById('quick-whatsapp').value.trim() || 'No provisto',
          user_message: document.getElementById('quick-message').value.trim() || 'Sin mensaje adicional',
          to_email: 'dataweb76@gmail.com'
        };
        if(!params.user_email){
          showConfirm(quickConfirm, 'Por favor ingres√° tu correo electr√≥nico.', false);
          return;
        }
        emailjs.send(SERVICE_ID, TEMPLATE_ID, params).then(()=> {
          showConfirm(quickConfirm, '‚úÖ Tu consulta fue enviada. Te responderemos pronto.', true);
          quickForm.reset();
          document.getElementById('quick-type').value = '';
        }, (err)=> {
          console.error('EmailJS error', err);
          showConfirm(quickConfirm, '‚ö†Ô∏è No se pudo enviar. Intent√° por WhatsApp.', false);
        });
      });

      function showConfirm(el, text, ok){
        el.style.display = 'block';
        el.textContent = text;
        if(ok){
          el.style.background = 'var(--success-bg)';
          el.style.border = '1px solid var(--success-border)';
        } else {
          el.style.background = '#fff0f0';
          el.style.border = '1px solid #e35b5b';
        }
        setTimeout(()=> { el.style.display='none'; }, 7000);
      }

      // enviarConsulta for CTA buttons
      window.enviarConsulta = function(tipo){
        // reuse EmailJS quick flow, show prompt to collect email if none
        const email = prompt('Ingres√° tu correo electr√≥nico para que te contactemos:');
        if(!email){ alert('No env√≠e la consulta: se requiere correo.'); return; }
        const params = {
          service_type: tipo,
          user_email: email,
          user_whatsapp: 'No provisto',
          user_message: 'Consulta v√≠a CTA r√°pida',
          to_email: 'dataweb76@gmail.com'
        };
        emailjs.send(SERVICE_ID, TEMPLATE_ID, params).then(()=> alert('‚úÖ Consulta enviada. Te contactamos por mail o WhatsApp.'), (err)=> { console.error(err); alert('Error al enviar.'); });
      };

      window.compartirInstagram = function(){
        const u = 'https://tuusuario.github.io/dataweb';
        navigator.clipboard.writeText(u).then(()=> alert('Enlace copiado. Pegalo en tu historia o bio de Instagram.'));
      };

      /* ---------- GEOLOCATION -> WEATHER & LOCAL NEWS via RSS ---------- */
      // Map provinces/countries to regional RSS feeds (Argentina focus)
      const regionalFeeds = {
        'LA PAMPA': ['https://www.laarena.com.ar/rss'],
        'BUENOS AIRES': ['https://www.clarin.com/rss/lo-ultimo/'],
        'CABA': ['https://www.lanacion.com.ar/arc/outboundfeeds/rss/?outputType=xml'],
        'CORDOBA': ['https://www.lavoz.com.ar/rss/lo-ultimo.xml'],
        'MENDOZA': ['https://www.losandes.com.ar/rss/'],
        'SANTA FE': ['https://www.ellitoral.com/rss/ultimas.xml'],
        'RIO NEGRO': ['https://www.rionegro.com.ar/feed/'],
        'NEUQUEN': ['https://www.lmneuquen.com/rss.xml'],
        'TUCUMAN': ['https://www.lagaceta.com.ar/rss/ultimas.xml'],
        'SALTA': ['https://www.eltribuno.com/salta/rss/ultimas.xml'],
        'MISIONES': ['https://www.elterritorio.com.ar/rss'],
        'CORRIENTES': ['https://www.diarioepoca.com/rss'],
        'CHACO': ['https://www.diarionorte.com/rss'],
        'DEFAULT_AR': ['https://www.infobae.com/rss/'],
        'SPAIN_DEFAULT': ['https://feeds.elpais.com/rss/elpais/portada']
      };

      // Helper: try to get geolocation (with fallback to ipapi)
      async function locate(){
        return new Promise((resolve)=>{
          if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(pos=> resolve({lat: pos.coords.latitude, lon: pos.coords.longitude}), async ()=> {
              try{ const r = await (await fetch('https://ipapi.co/json/')).json(); resolve(r); }catch(e){ resolve(null); }
            }, {timeout:7000});
          } else {
            fetch('https://ipapi.co/json/').then(r=>r.json()).then(j=>resolve(j)).catch(()=>resolve(null));
          }
        });
      }

      // Use allorigins CORS proxy to fetch RSS and parse
      async function fetchRSS(feedUrl){
        try{
          const proxy = 'https://api.allorigins.win/raw?url=';
          const res = await fetch(proxy + encodeURIComponent(feedUrl));
          if(!res.ok) throw new Error('no ok');
          const txt = await res.text();
          const doc = new DOMParser().parseFromString(txt,'application/xml');
          return doc;
        }catch(e){ console.warn('RSS fetch error', e); return null; }
      }

      // parse rss xml doc to list items
      function parseRSStoItems(xmlDoc, maxItems=5){
        if(!xmlDoc) return [];
        const items = Array.from(xmlDoc.querySelectorAll('item')).slice(0,maxItems);
        if(items.length===0){
          // try alternative tags
          const entries = Array.from(xmlDoc.querySelectorAll('entry')).slice(0,maxItems);
          return entries.map(en => ({ title: en.querySelector('title') ? en.querySelector('title').textContent : 'Sin t√≠tulo', link: en.querySelector('link') ? (en.querySelector('link').getAttribute('href')||en.querySelector('link').textContent) : '#' }));
        }
        return items.map(it => ({ title: it.querySelector('title') ? it.querySelector('title').textContent : 'Sin t√≠tulo', link: it.querySelector('link') ? it.querySelector('link').textContent || it.querySelector('link').getAttribute('href') : '#' }));
      }

      // select feed by location meta
      function selectFeeds(meta){
        // meta may contain country (code or name), region, city
        if(!meta) return regionalFeeds['DEFAULT_AR'];
        const country = (meta.country || meta.country_code || '').toString().toUpperCase();
        const region = (meta.region || meta.region_name || '').toString().toUpperCase();
        // Argentina
        if(country === 'AR' || country === 'ARGENTINA'){
          // try region mapping
          for(const key of Object.keys(regionalFeeds)){
            if(region.includes(key) || key.includes(region)) return regionalFeeds[key];
          }
          // fallback default
          return regionalFeeds['DEFAULT_AR'];
        }
        // Spain
        if(country === 'ES' || country === 'SPAIN' || (meta.country_name && meta.country_name.toUpperCase().includes('ESPA√ëA'))){
          return regionalFeeds['SPAIN_DEFAULT'];
        }
        // Default global
        return ['https://news.google.com/rss'];
      }

      async function showNewsFor(meta){
        const target = document.getElementById('news-list');
        target.innerHTML = '<p class="muted">Cargando noticias...</p>';
        const feeds = selectFeeds(meta);
        let collected = [];
        for(const f of feeds){
          const xml = await fetchRSS(f);
          const items = parseRSStoItems(xml,5);
          if(items && items.length) { collected = items; break; }
        }
        if(collected.length){
          target.innerHTML = '<ul style="padding-left:18px;margin:6px 0">' + collected.map(it => `<li style="margin-bottom:8px"><a href="${it.link}" target="_blank" rel="noopener">${it.title}</a></li>`).join('') + '</ul>';
        } else {
          target.innerHTML = '<p class="muted">No se encontraron titulares regionales. Mostrando noticias nacionales.</p><p><a href="https://www.infobae.com" target="_blank">Infobae</a> ‚Ä¢ <a href="https://www.clarin.com" target="_blank">Clar√≠n</a> ‚Ä¢ <a href="https://www.lanacion.com.ar" target="_blank">La Naci√≥n</a></p>';
        }
      }

      // Display weather using open-meteo
      async function showWeather(lat, lon, cityName){
        const el = document.getElementById('clima-content');
        el.innerHTML = '<p class="muted">Obteniendo clima...</p>';
        try{
          const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&timezone=auto`;
          const r = await fetch(url);
          const j = await r.json();
          if(j && j.current_weather){
            const cw = j.current_weather;
            el.innerHTML = `<div style="font-weight:700">${cityName || ''}</div><div style="font-size:1.6rem;font-weight:700;margin-top:6px">${cw.temperature}¬∞C</div><div class="muted" style="margin-top:6px">Viento: ${cw.windspeed} km/h ‚Ä¢ C√≥digo: ${cw.weathercode}</div><div style="margin-top:8px"><a class="muted" href="https://open-meteo.com/" target="_blank">Fuente: Open-Meteo</a></div>`;
            return;
          }
        }catch(e){ console.warn('weather error', e); }
        el.innerHTML = '<p class="muted">No se pudo obtener el clima.</p>';
      }

      // Attempt to load Dolar
      (function loadDolar(){
        const oEl = document.getElementById('d-oficial');
        const bEl = document.getElementById('d-blue');
        fetch('https://api.bluelytics.com.ar/v2/latest').then(r=>r.json()).then(data=>{
          if(data){
            const of = data.oficial || data.oficial || {};
            const blue = data.blue || {};
            const ofVal = of.value_sell || of.value || '‚Äî';
            const blueVal = blue.value_sell || blue.value || '‚Äî';
            oEl.textContent = (typeof ofVal === 'number') ? ofVal.toFixed(2) : ofVal;
            bEl.textContent = (typeof blueVal === 'number') ? blueVal.toFixed(2) : blueVal;
          }
        }).catch(()=> { oEl.innerHTML = '<a href="https://www.dolarhoy.com/" target="_blank">Ver</a>'; bEl.innerHTML = '<a href="https://www.dolarhoy.com/" target="_blank">Ver</a>'; });
      })();

      // Initialize location -> weather & news
      (async function init(){
        const loc = await locate();
        if(!loc){
          // fallback defaults to Santa Rosa, La Pampa
          showWeather(-36.6167, -64.2833, 'Santa Rosa (La Pampa)');
          showNewsFor({country:'AR', region:'LA PAMPA', city:'Santa Rosa'});
          return;
        }
        // normalize meta
        const meta = {
          lat: loc.latitude || loc.lat || loc.latitud || loc.lat,
          lon: loc.longitude || loc.lon || loc.longitude,
          city: loc.city || loc.city || loc.city,
          region: loc.region || loc.region || loc.region_name || loc.regionName,
          country: (loc.country || loc.country_code || loc.country_name || '').toString()
        };
        if(meta.lat && meta.lon){
          showWeather(meta.lat, meta.lon, meta.city || meta.region);
        } else {
          // try ipapi for coordinates
          try{
            const ipj = await (await fetch('https://ipapi.co/json/')).json();
            meta.lat = ipj.latitude; meta.lon = ipj.longitude; meta.city = ipj.city; meta.region = ipj.region; meta.country = ipj.country;
            showWeather(meta.lat, meta.lon, meta.city || meta.region);
          }catch(e){ showWeather(-36.6167, -64.2833, 'Santa Rosa (La Pampa)'); }
        }
        // show news (pass meta object)
        showNewsFor(meta);
      })();

    })();
  </script>
</body>
</html>





